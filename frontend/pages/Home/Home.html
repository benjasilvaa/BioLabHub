<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Home | BIOLABHUB</title>
  <link rel="icon" href="{{ url_for('static', filename='assets/LOGO-SOLO.ico') }}" type="image/png">
  <link rel="stylesheet" href="{{ url_for('static', filename='home/Home.css') }}" />
</head>

<body>
  
  <nav class="navbar">
    <div class="logo-container">
      <img src="{{ url_for('static', filename='assets/BioLabHub (negro).png') }}" alt="BioLabHub Logo">
    </div>
    <div class="user-avatar">
      {% if 'usuario_id' in session %}
        <span>{{ session['nombre'] }}</span>
        <a href="{{ url_for('login_bp.logout') }}" class="logout-btn">Cerrar sesiÃ³n</a>
      {% else %}
        <a href="{{ url_for('login_bp.login') }}" class="logout-btn">Iniciar sesiÃ³n</a>
        <a href="{{ url_for('login_bp.register') }}" class="logout-btn" style="background-color:#43a047;">Registrarse</a>
      {% endif %}
    </div>
  </nav>

  <div class="content">
    
    <div class="sidebar">
      <nav>
        <a href="{{ url_for('home_bp.home') }}" class="active">Inicio</a>
        <a href="{{ url_for('samples_bp.samples') }}">SampleTrack</a>
        <a href="{{ url_for('experiments_bp.experiments') }}">Experiment Planner</a>
        <a href="{{ url_for('equipments_bp.equipreserve') }}">EquipReserve</a>
        {% if session.get("rol") == "admin" %}
        <a href="{{ url_for('admin_bp.admin_panel') }}" style="color: #ffcc00; font-weight: bold;">
           Panel Admin
        </a>
        {% endif %}
      </nav>
    </div>

    
    <div class="main">

      {% if session.get('rol') == 'invitado' and 'usuario_id' not in session %}

      <!-- Vista especial para invitados -->
      <section class="welcome">
        <h1>Bienvenido a BioLabHub como invitado</h1>
        <p class="desc">
          Explora la plataforma y descubre todo lo que puedes hacer si creas una cuenta o inicias sesiÃ³n.
        </p>
        <div class="stats-grid">
          <div class="stat-card">
            <h2>âœ”</h2>
            <p>Visualizar el panel y navegaciÃ³n bÃ¡sica</p>
          </div>
          <div class="stat-card">
            <h2>ðŸ”’</h2>
            <p>Registrar muestras (requiere cuenta)</p>
          </div>
          <div class="stat-card">
            <h2>ðŸ”’</h2>
            <p>Crear y planificar experimentos</p>
          </div>
          <div class="stat-card">
            <h2>ðŸ”’</h2>
            <p>Reservar equipos del laboratorio</p>
          </div>
        </div>
        <div class="qa-grid" style="margin-top: 1.5rem;">
          <a href="{{ url_for('login_bp.login') }}" class="qa-item">
            <img src="{{ url_for('static', filename='assets/icon-experiment.png') }}">
            <h3>Iniciar sesiÃ³n</h3>
          </a>
          <a href="{{ url_for('login_bp.register') }}" class="qa-item">
            <img src="{{ url_for('static', filename='assets/icon-sample.png') }}">
            <h3>Crear cuenta y empezar</h3>
          </a>
        </div>
      </section>

      {% else %}

      <!-- Vista normal para usuarios autenticados -->
      <section class="welcome">
        <h1>Hola {{ session['nombre'] }}, bienvenido a BioLabHub </h1>
        <p class="desc">
          Tu centro de control para gestionar muestras, experimentos, reactivos y reservas de equipos.
        </p>

        <div class="stats-grid">
          <div class="stat-card">
            <h2>{{ stats.experimentos_activos }}</h2>
            <p>Experimentos activos</p>
          </div>
          <div class="stat-card">
            <h2>{{ stats.reservas_activas }}</h2>
            <p>Reservas de equipos</p>
          </div>
          <div class="stat-card">
            <h2>{{ stats.muestras_registradas }}</h2>
            <p>Muestras registradas</p>
          </div>
          <div class="stat-card">
            <h2>{{ stats.reactivos_reponer }}</h2>
            <p>Reactivos a reponer</p>
          </div>
        </div>
      </section>

      <section class="quick-access">
        <h2>Accesos rÃ¡pidos</h2>
        <div class="qa-grid">

          <a href="{{ url_for('samples_bp.samples') }}" class="qa-item">
            <img src="{{ url_for('static', filename='assets/icon-sample.png') }}">
            <h3>Registrar muestra</h3>
          </a>

          <a href="{{ url_for('experiments_bp.experiments') }}" class="qa-item">
            <img src="{{ url_for('static', filename='assets/icon-experiment.png') }}">
            <h3>Nuevo experimento</h3>
          </a>

          <a href="{{ url_for('reagents') }}" class="qa-item">
            <img src="{{ url_for('static', filename='assets/icon-chem.png') }}">
            <h3>Revisar reactivos</h3>
          </a>

          <a href="{{ url_for('equipments_bp.equipreserve') }}" class="qa-item">
            <img src="{{ url_for('static', filename='assets/icon-microscope.png') }}">
            <h3>Reservar equipo</h3>
          </a>

        </div>
      </section>

      <section class="activity">
        <h2>Tu actividad reciente</h2>
        <ul class="activity-list">

          {% if actividad %}
            {% for item in actividad %}
              <li>
                <span class="icon"></span>
                <p>{{ item }}</p>
              </li>
            {% endfor %}
          {% else %}
            <p>No registras actividad reciente.</p>
          {% endif %}

        </ul>
      </section>

      <section class="experiments">
        <h2>TUS EXPERIMENTOS</h2>
        <div class="experiment-list">

          {% if experimentos %}
            {% for exp in experimentos %}
            <div class="experiment">
              <img src="{{ url_for('static', filename='assets/lab1.png') }}" alt="Experimento">
              <div class="overlay">
                <h3>{{ exp["titulo"] }}</h3>
                <p>{{ exp["descripcion"][:120] }}...</p>
                <p><strong>Inicio:</strong> {{ exp["fecha_inicio"] }}</p>
                <p><strong>Estado:</strong> {{ exp["estado"] }}</p>
              </div>
            </div>
            {% endfor %}
          {% else %}
            <p>No tienes experimentos registrados.</p>
          {% endif %}

        </div>
      </section>

      <section class="equipment">
        <h2>EQUIPOS RESERVADOS</h2>
        <div class="equipment-list">

          {% if equipos %}
            {% for eq in equipos %}
            <div class="equipment-item">
              <img src="{{ url_for('static', filename='assets/microscopio.png') }}" alt="Equipo">
              <div class="overlay">
                <h3>{{ eq["equipo"] }}</h3>
                <p><strong>Desde:</strong> {{ eq["fecha_inicio"] }}</p>
                <p><strong>Hasta:</strong> {{ eq["fecha_fin"] }}</p>
                <p><strong>Estado:</strong> {{ eq["estado"] }}</p>
              </div>
            </div>
            {% endfor %}
          {% else %}
            <p>No tienes equipos reservados.</p>
          {% endif %}

        </div>
      </section>

      <section class="news">
        <h2>Novedades del laboratorio </h2>
        <ul class="news-list">
          <li> Nuevo lote de reactivos cargado en ReagentVault.</li>
          <li> ActualizaciÃ³n: algunos equipos estÃ¡n en mantenimiento.</li>
          <li> Agregado soporte para historial de muestras.</li>
          <li> Mejoras en seguridad y auditorÃ­a del sistema.</li>
        </ul>
      </section>

      {% endif %}

    </div>
  </div>

  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script src="/static/socket.js"></script>

</body>
</html>
